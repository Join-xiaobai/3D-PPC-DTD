目标是利用前几步构建的“药理点云”高维特征空间，训练一个机器学习模型来预测药物-靶点对是否具有“右心室特异性”（RV-specific）效应，并对模型性能和关键发现进行深入解读。

整个流程可以分为两大块：

第一部分：构建并训练 RV 特异性分类器

定义预测任务：
    **目标变量 **(Y)：基于 rv_disease_log2fc 创建二元标签 is_rv_specific。
        1 (RV阳性)：rv_disease_log2fc >= 1.0 （在适应不良性右心室中显著上调）
        0 (RV阴性)：rv_disease_log2fc <= -0.5 （在适应不良性右心室中下调或无变化）
    **特征 **(X)：使用 Step5 生成的 103 维高维特征向量，包含化学、功能、表达等多维度信息。

数据预处理与平衡：
    原始数据极度不平衡（RV阳性样本仅占 ~1.4%）。
    解决方案：采用 **SMOTE **(Synthetic Minority Over-sampling Technique) 对训练集中的少数类（RV阳性）进行过采样，以缓解类别不平衡问题。

模型选择与训练：
    算法：选用 XGBoost，因其在处理表格数据和特征重要性方面表现优异。
    验证策略：采用 **分层五折交叉验证 **(Stratified 5-Fold CV)，确保每一折中正负样本比例一致。
    评估指标：主要关注 AUC-ROC（衡量模型整体判别能力）和 **精确率-召回率曲线下面积 **(AUC-PR)（在不平衡数据下更可靠）。

模型性能：
    AUC-ROC: 0.97 （非常优秀）
    AUC-PR: 0.82 （在如此不平衡的数据下，这是一个极佳的结果）
    结论：模型能够非常有效地从复杂的药理特征中识别出具有 RV 特异性效应的药物-靶点对。

第二部分：模型解读与关键生物学发现

特征重要性分析：
    使用 XGBoost 内置的 weight 方法评估特征重要性。
    Top 3 最重要特征：
        rv_disease_log2fc：这是定义标签的直接依据，重要性最高是合理的。
        **ECFP4_PC_1 (X轴)：药物化学结构的主成分，表明化学结构是预测 RV 效应的关键决定因素**。
        **GO_BP_PC_1 (Y轴)：靶点功能的主成分，表明靶点的生物学功能同样至关重要**。
    意义：这验证了“药理点云”框架（X-Y-Z 轴）的有效性，化学和功能维度确实捕获了与 RV 病理相关的核心信息。

生成全量预测：
    在整个数据集上应用训练好的模型，生成每个 (Drug, Target) 对的 **RV 阳性概率 **(rv_prob)。
    产出：step6_predictions.csv，包含原始特征、真实标签和模型预测概率。

关键发现与可视化：
    RV 概率热力图：在 X-Y（化学-功能）平面上绘制 rv_prob 的核密度热力图。
        发现：RV 高概率区域并非均匀分布，而是集中在几个特定的“热点”。这表明只有特定化学类型的药物作用于特定功能类别的靶点时，才会产生强烈的 RV 特异性效应。
    Top 10 高置信度 RV 预测：
        惊人发现：Top 10 预测全部指向同一个靶点——TNNI3（心肌肌钙蛋白 I），且预测概率均为 1.0。
        生物学意义：TNNI3 是心肌收缩的核心调控蛋白，其在右心室中的特异性失调与心力衰竭密切相关。模型精准地识别出了这一关键靶点。
        特异性验证：这些 Top 10 样本的 pv_disease_log2fc 均为 0.0，表明它们只影响右心室，而不影响肺血管，完美契合了项目寻找“RV-specific”的核心目标。

总结

构建了高性能预测模型：通过 XGBoost 和 SMOTE，成功克服了数据不平衡的挑战，建立了一个 AUC-ROC=0.97 的强大分类器。
验证了“药理点云”框架：特征重要性分析证明，化学（X）和功能（Y）主轴是预测 RV 效应的核心驱动力。
产出了高价值的生物学洞见：模型不仅是一个黑箱，更精准地指出了 TNNI3 作为最核心的 RV 特异性靶点，并找到了一组对其有高置信度预测的化合物。这为后续的实验验证（如测试这些化合物对 TNNI3 的调控作用）提供了极其明确和高优先级的候选列表。