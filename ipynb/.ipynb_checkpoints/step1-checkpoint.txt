生物信息学分析流程的第一步，主要目标是从 GTEx (Genotype-Tissue Expression) 数据库中识别在肺（Lung）和心脏（Heart）组织之间差异表达的基因，并为后续的深入分析（如富集分析、可药性靶点筛选）准备高质量的数据集。

整个过程可以清晰地分为两个主要阶段：

第一阶段：数据质量控制 (Quality Control)

这个阶段的目标是确保输入数据的质量可靠，为后续分析打下坚实基础。

数据加载：
    从 data/processed/step1/gtex_lung_heart_tpm.csv 文件中读取基因表达数据。
    数据包含两列：lung_tpm 和 heart_tpm，代表每个基因在肺和心脏组织中的表达量（单位为 TPM - Transcripts Per Million）。

基本统计与完整性检查：
    完整性：确认数据集中没有缺失值（54,592 个基因的 lung_tpm 和 heart_tpm 均无缺失）。
    表达分布：
        大部分基因处于低表达水平（肺中位数 ≈ 0.16，心脏中位数 ≈ 0.03）。
        存在少数极高表达的基因（最大值 > 20,000），这符合 TPM 数据的典型特征。
        肺和心脏的整体平均表达水平相近（均值 ~18），但心脏组织中存在更极端的高表达基因（标准差更大）。

可视化：
    绘制了 肺 vs 心脏 的散点图（对数坐标）。
    这张图直观地展示了两个组织间基因表达的相关性和离散程度，验证了数据的合理性。

结论：数据质量良好，通过了质控，可以进入下一阶段。

第二阶段：差异表达基因 (Differentially Expressed Genes, DEGs) 分析

这个阶段的核心任务是找出在肺和心脏中表达水平有显著差异的基因。

计算关键指标：
    平均表达量 (mean_tpm)：(lung_tpm + heart_tpm) / 2，用于过滤掉整体表达量过低、可能不可靠的基因。
    对数倍数变化 (log2fc)：log2((lung_tpm + 1) / (heart_tpm + 1))，衡量基因在肺相对于心脏的表达变化幅度。正值表示肺富集，负值表示心脏富集。

筛选差异基因：
    设定了两个阈值来定义“显著差异”：
        表达量阈值：mean_tpm > 1 （排除低丰度噪声）。
        变化幅度阈值：|log2FC| > 2 （即表达量相差至少4倍）。
    根据这两个条件，共筛选出 4,903 个 差异表达基因。

分类与保存：
    将差异基因分为两类：
        肺富集基因 (Lung-enriched)：log2fc > 2
        心脏富集基因 (Heart-enriched)：log2fc < -2
    将所有结果分别保存到 results/step1_outputs/ 目录下的多个 CSV 文件中，包括：
        所有差异基因列表 (differential_genes.csv)
        肺富集基因列表 (lung_enriched_genes.csv)
        心脏富集基因列表 (heart_enriched_genes.csv)
        各自的 Top 20 基因 (top20_lung_enriched.csv, top20_heart_enriched.csv)

结果摘要：
    最终得到了约 2,500+ 个肺富集基因和 2,400+ 个心脏富集基因。
    这表明肺和心脏在转录组水平上存在非常显著的差异，为后续的功能研究提供了宝贵的候选基因集。

总结：
step1.ipynb 成功完成了以下核心工作：
验证了 GTEx 肺/心表达数据的可靠性。
系统性地识别并分类了 4,903 个在肺和心脏组织间差异表达的基因。
生成了结构化的、可供下游分析（如步骤2的富集分析）直接使用的基因列表文件。