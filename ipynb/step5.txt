目标是构建一个三维“药理点云”（Pharmacological Point Cloud）来直观地展示和探索药物-靶点对在化学、功能和表达空间中的分布，并在此基础上进行深入的生物学解读和候选药物优先级排序。

整个流程可以分为两大块：

第一部分：构建三维药理坐标系 (XYZ)

这是本步骤最具创新性和技术性的部分，为每个 (Drug, Target) 对定义了三个正交的生物学维度：

**X 轴 - 化学主轴 **(Chemical Axis)
    方法：为每个药物的 SMILES 计算 ECFP4 指纹（2048维），然后对所有指纹进行 全局 PCA，取第一主成分 (PC1) 作为 X 坐标。
    意义：代表药物化学结构的主要变化方向。

**Y 轴 - 功能主轴 **(Functional Axis)
    方法：基于靶点基因的 **GO Biological Process **(GO BP)，构建二值化功能矩阵，再进行 全局 PCA，取 PC1 作为 Y 坐标。
    意义：代表靶点生物学功能的主要变化方向。

**Z 轴 - 表达中性轴 **(Expression Axis)
    方法：使用 GTEx 全组织平均 TPM 的对数值 (log10(mean_median_TPM + 1)) 作为 Z 坐标。
    关键设计：刻意避免使用肺或心脏特异性表达，以保持 Z 轴的“中性”，防止引入先验偏倚，确保点云能公平地反映化学和功能信息。

产出：一个包含 1,573 个 (Drug, Target) 对及其 XYZ 坐标的文件 drug_target_pairs_with_XYZ.csv。

第二部分：构建高维特征矩阵并进行深度分析

在三维坐标的基础上，为每个 (Drug, Target) 对构建了一个丰富的 111 维特征向量，用于下游分析：

特征工程：
    化学特征：64D ECFP4-PCA + 7D 理化性质（如 LogP, MW, QED 等）。
    功能特征：32D GO-BP PCA。
    疾病特异性特征：从 Step4 引入的 pv_disease_log2fc 和 rv_disease_log2fc。
    其他：保留 is_approved_drug, pchembl_value 等元信息。

关键发现与洞察：
    数据集局限性分析：发现许多在 RV 中高度失调的关键基因（如 SPP1, TNC）并未出现在 ChEMBL 的可药靶点列表中。这并非分析错误，而是反映了公共药物数据库的固有局限——它们主要覆盖传统的小分子可药靶点（如激酶、GPCR），而新兴的生物标志物（如分泌蛋白）往往未被收录。
    候选药物优先级排序：尽管存在上述局限，分析仍成功识别出针对已知可药靶点（如 TNNI3）的高 rv_log2fc 药物。
    验证分析：建议对高 rv_log2fc 靶点进行 GO/KEGG 富集，以验证其是否富集于“纤维化”、“炎症”等 RV 相关通路（此分析在 Notebook 中被列为下一步）。

可视化：
    绘制了 3D 药理点云图，用颜色区分了三种响应类型：Non-significant（无显著疾病信号）、PV-specific（仅肺血管特异）、RV-specific（仅右心室特异）。
    结论：点云成功地将具有不同生物学背景的药物-靶点对在空间上区分开来，证明了该框架的有效性。

总结

创新性建模：创造性地构建了 X(化学)-Y(功能)-Z(中性表达) 的三维药理空间，为药物-靶点关系提供了全新的、多维度的可视化视角。
严谨的数据处理：通过使用“中性”的 Z 轴，避免了信息泄露，保证了模型的客观性。
深刻的生物学洞见：诊断出了公共数据库的局限性，并据此提出了更合理的后续研究方向（如转向 Open Targets 或网络药理学）。
明确的产出：生成了可用于机器学习建模的高质量特征矩阵 (drug_target_pairs_final_features.csv) 和直观的 3D 可视化图。